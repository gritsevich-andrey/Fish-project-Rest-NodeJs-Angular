<div class="content">
  <span class="teal-text">Присоедниненная поездка</span>
  <div class="freeSeats">
    Свободные места - {{travel.peoplesCount - getJoinedUsers().length}} / {{travel.peoplesCount }}
  </div>
  <div class="status">
    Статус - {{travelStatus}}
  </div>
  <div class="status" *ngIf="travelStatus === 'Отказано'">
    Описание отказа - {{getRejectReason()}}
  </div>
  <div *ngIf="userStatus === 'Ожидает оплаты'">
    <button
      data-target="makeOffer"
      matTooltip="Оплатить поездку"
      class="btn payButton"
      (click)="fakePay()"
    >
      Оплатить
    </button>
  </div>
  <div *ngIf="userStatus === 'Оплачено'">
    <div *ngIf="travel.status !== 'ended'">
      <h3 class="tableTitle">Присоединившиеся пользователи</h3>
      <table>
        <thead>
        <tr>
          <th>№</th>
          <th>ФИО</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let user of acceptedUsers, let j = index">
          <td>{{j + 1}}</td>
          <td (click)="openUserProfile(user.userEmail)"><span class="pointer">{{user.fio || user.nickName}}</span></td>
        </tr>
        </tbody>
      </table>
    </div>
    <div *ngIf="travel.status === 'ended'" class="reviewRatingContainer">
      <table>
        <thead>
        <tr>
          <th>№</th>
          <th>ФИО</th>
          <th>Жалоба</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let user of getUsersWithoutUser(acceptedUsers, userEmail), let j = index">
          <td>{{j + 1}}</td>
          <td (click)="openUserProfile(user.userEmail)"><span class="pointer">{{user.fio || user.nickName}}</span></td>
          <td>
            <button class="btn" (click)="openComplaint(user.userEmail)">Написать</button>
          </td>
        </tr>
        </tbody>
      </table>

      <span>Оставить отзыв:</span>
      <button [disabled]="isSetReview" class="waves-effect waves-light btn"
              (click)="openReviewDialog(travel.userEmail)">Отзыв
      </button>
      <div class="ratingContainer">
        <span>Оценить поездку:</span>
        <form [formGroup]="form">
          <ngx-star-rating
            formControlName="rating"
            [id]="travel._id + userEmail"
            [disabled]="isSetRating"
          ></ngx-star-rating>
        </form>
        <button [disabled]="isSetRating" class="waves-effect waves-light btn"
                (click)="saveRating(travel.userEmail)"
                matTooltip="сохранить отзыв на поездку">Сохранить
        </button>
      </div>
    </div>
  </div>
  <div class="rejectButton">
    <button *ngIf="travel.status !== 'ended'" class="btn" (click)="leaveFromTravel()">Отказаться</button>
    <button class="btn" (click)="openComplaint(travel.userEmail)">Пожаловаться на поездку</button>
  </div>

</div>
