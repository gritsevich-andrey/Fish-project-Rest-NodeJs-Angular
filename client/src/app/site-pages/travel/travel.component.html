<h1>Список предложенных мест</h1>
<!--<table matSort (matSortChange)="sortData($event)">-->
<!--  <thead>-->
<!--  <tr>-->
<!--    <th>№</th>-->
<!--    <th mat-sort-header="title">Название</th>-->
<!--    <th mat-sort-header="date">Дата</th>-->
<!--    <th>Описание</th>-->
<!--    <th>Повторить/скрыть</th>-->
<!--    <th>Редактировать</th>-->
<!--  </tr>-->
<!--  </thead>-->
<!--  <tbody>-->
<!--  <tr *ngFor="let item of userTravels, let i = index">-->
<!--    <td>{{i + 1}}</td>-->
<!--    <td>{{item.title}}</td>-->
<!--    <td>{{item.date | date:'dd/MM/yyyy'}}</td>-->
<!--    <td>{{item.description}}</td>-->
<!--    <td>-->
<!--      <a-->
<!--        *ngIf="item.isPublic"-->
<!--        class="waves-effect waves-light btn"-->
<!--        matTooltip="Скрыть поездку на карте"-->
<!--        (click)="setTravelPublic(item._id)"-->
<!--      >Скрыть</a>-->
<!--      <a-->
<!--        *ngIf="!item.isPublic"-->
<!--        class="waves-effect waves-light btn"-->
<!--        (click)="setTravelPublic(item._id)"-->
<!--        matTooltip="Повторить поездку"-->
<!--      >Повторить</a>-->
<!--    </td>-->
<!--    <td>-->
<!--      <button-->
<!--        class="waves-effect waves-light btn modal-trigger"-->
<!--        data-target="editTravel"-->
<!--        (click)="openEditTravel(item)"-->
<!--        matTooltip="Редактировать поездку"-->
<!--      >Редактировать-->
<!--      </button>-->
<!--    </td>-->
<!--  </tr>-->
<!--  </tbody>-->
<!--</table>-->

<div matSort (matSortChange)="sortData($event)">
  <div class="travelsList">
    <div mat-sort-header="title">
      <strong>Название</strong>
    </div>
    <div mat-sort-header="date">
      <strong>Дата</strong>
    </div>
    <div>
      <strong>Описание</strong>
    </div>
  </div>
  <hr/>
  <div *ngFor="let item of userTravels, let i = index">
    <div class="travelsList">
      <div>
        {{item.title}}
      </div>
      <div>
        {{item.date | date:'dd/MM/yyyy'}}
      </div>
      <div>
        {{item.description}}
      </div>
    </div>
    Этот пользователь создатель поездки? <strong>{{userEmail === item.userEmail}}</strong>
    <div *ngIf="userEmail === item.userEmail">
      <a
        *ngIf="item.isPublic"
        class="waves-effect waves-light btn"
        matTooltip="Скрыть поездку на карте"
        (click)="setTravelPublic(item._id)"
      >Скрыть
      </a>
      <a
        *ngIf="!item.isPublic"
        class="waves-effect waves-light btn"
        (click)="setTravelPublic(item._id)"
        matTooltip="Повторить поездку"
      >Повторить</a>
      <button
        class="waves-effect waves-light btn modal-trigger"
        data-target="editTravel"
        matTooltip="Редактировать поездку"
        (click)="openEditTravel(item)"
      >Редактировать
      </button>
      <br/>
      Тут будет еще другой функционал
    </div>
    <div *ngIf="userEmail !== item.userEmail">
      Статус - {{getUserStatus(userEmail, item)}}
      <br/>
      Тут будет еще другая информация
    </div>
    <hr/>
  </div>
</div>

<div class="makeOffer">
  <button
    data-target="makeOffer"
    matTooltip="Сформировать условия для поездки, дату отправления, стоимость и подробное описание. "
    class="btn modal-trigger"
    (click)="form.reset()"
  >
    Предложить поездку
  </button>
</div>

<div id="addTransport" class="modal">
  <form [formGroup]="techniqueForm" (ngSubmit)="techniqueFormSubmit()">
    <div class="modal-content">
      <h1>Добавьте технику</h1>
      <div formArrayName="technique" *ngFor="let technique of techList.controls; let i = index;">
        <div [formGroupName]="i">
          <label (change)="selectTransport(i, technique.value.selected)">
            <input type="checkbox" [checked]="technique.value.selected"/>
            <span>Выбрать</span>
          </label>
          <input type="text" placeholder="Название техники" formControlName="name"
                 matTooltip="Указать технику, на которой оказываются услуги">
          <input type="text" placeholder="Права на управление" formControlName="license"
                 matTooltip="Указать категорию прав на управление">
          <div class="form-group">
            <i class="material-icons" (click)="removeTechnique(i)" matTooltip="Удалить технику">remove_box</i>
          </div>
        </div>
      </div>
      <i class="material-icons" (click)="addTechnique()" matTooltip="Добавить технику">add_box</i>
      <div>
        <button id="close-tech-modal" class="waves-effect waves-light btn modal-close" type="button">Отмена</button>
        <button class="waves-effect waves-light btn" type="submit">Выбрать и Сохранить</button>
      </div>
    </div>
  </form>
</div>

<input (change)="setTravelDate($event)" [hidden]="true" type="text" class="datepicker" #datepicker>
<div id="makeOffer" class="modal">
  <div class="mat-form-field-flex">
    <form [formGroup]="form" (ngSubmit)="onSubmit('create')">
      <div class="modal-content">
        <div>
          <strong>{{form.controls.travelDate.value | date:'dd.MM.yyyy' }}</strong>
          <button (click)="datepicker.click()" class="waves-effect waves-light btn" type="button">Дата поездки</button>
        </div>
        <div>
          <span class="addPhoto">Добавить обложку поездки</span>
          <input (change)="onFileLoad($event)" type="file" [hidden]="true" #inputFile>
          <button class="waves-effect waves-light btn" type="button" (click)="inputFile.click()">Выбрать изображение
          </button>
        </div>
        <div class="input-field select-field-item">
          <select formControlName="travelType" class="icons" (change)="travelTypeChange()">
            <option value="" disabled selected>Выбрать технику</option>
            <option value="onFoot" class="left">Нет</option>
            <option value="technique" class="left">Выбрать</option>
          </select>
        </div>
        <div *ngIf="isTechnique">
          <button data-target="addTransport" class="waves-effect waves-light btn modal-trigger"
                  (click)="this.loadTransport()">Выбрать технику
          </button>
        </div>
        <div class="buttonBlock">
          <span>Куда поехать?</span>
          <button data-target="startPointMap" class="waves-effect waves-light btn modal-trigger">Указать на карте
          </button>
        </div>
        <div class="buttonBlock">
          <span>Откуда выезд?</span>
          <button data-target="endPointMap" class="waves-effect waves-light btn modal-trigger">Указать на карте</button>
        </div>
        <div class="input-field select-field-item">
          <select class="icons" formControlName="travelTarget">
            <option value="" selected disabled>Цель поездки</option>
            <option value="Охота" class="left">Охота</option>
            <option value="Рыбалка" class="left">Рыбалка</option>
            <option value="Туризм" class="left">Туризм</option>
          </select>
        </div>
        <div *ngIf="isDriver" class="input-field col s6">
          <input id="peoplesCount" formControlName="peoplesCount" type="number" min="1" class="validate"/>
          <label for="peoplesCount">Количество человек</label>
          <span class="helper-text red-text" *ngIf="f.peoplesCount.touched && f.peoplesCount.invalid">
            <small *ngIf="f.peoplesCount.hasError('required')">Поле не должно быть пустым</small>
        </span>
        </div>
        <div class="input-field col s6">
          <input id="costPerPeople" formControlName="costPerPeople" type="number" min="0" class="validate"/>
          <label for="costPerPeople">Цена за 1 чел.</label>
          <span class="helper-text red-text" *ngIf="f.costPerPeople.touched && f.costPerPeople.invalid">
            <small *ngIf="f.costPerPeople.hasError('required')">Поле не должно быть пустым</small>
        </span>
        </div>
        <div class="input-field col s12">
          <textarea id="description" cols="30" rows="10" formControlName="description"></textarea>
          <label for="description">Подробное описание</label>
          <span class="helper-text red-text" *ngIf="f.description.touched && f.description.invalid">
            <small *ngIf="f.description.hasError('required')">Поле не должно быть пустым</small>
        </span>
        </div>
      </div>
      <div class="modal-footer">
        <button type="submit" id="button-modal-close" class="btn">Создать</button>
        <button type="button" class="btn ml10" (click)="closeModal('create')">Отмена</button>
      </div>
    </form>
  </div>
</div>

<div id="startPointMap" class="modal">
  <div class="modal-content">
    <div class="mapContainer">
      <ya-map [center]="[55.751952, 37.600739]" [zoom]="10" (ready)="onStartPointMapReady($event)">
        <ya-placemark
          *ngFor="let placemark of placemarksStart"
          [geometry]="placemark?.geometry"
          [options]="placemark?.options"
        ></ya-placemark>
      </ya-map>
    </div>
  </div>
  <div class="modal-footer">
    <button class="modal-close waves-effect waves-green btn-flat">Подтвердить</button>
  </div>
</div>

<div id="endPointMap" class="modal">
  <div class="modal-content">
    <div class="mapContainer">
      <ya-map [center]="[55.751952, 37.600739]" [zoom]="10" (ready)="onEndPointMapReady($event)"></ya-map>
    </div>
  </div>
  <div class="modal-footer">
    <button class="modal-close waves-effect waves-green btn-flat">Подтвердить</button>
  </div>
</div>


<div id="editTravel" class="modal">
  <div class="mat-form-field-flex">
    <form [formGroup]="form" (ngSubmit)="onSubmit('update')">
      <div class="modal-content">
        <!--        <div class="input-field col s6">-->
        <!--          <input id="travelTitle" disabled [value]="-->
        <!--          form.controls.travelTarget.value === 'tourism' ? 'Туризм' :-->
        <!--          form.controls.travelTarget.value === 'fishing' ? 'Рыбалка' :-->
        <!--          form.controls.travelTarget.value === 'hunting' ? 'Охота' : ''-->
        <!--        " type="text" class="validate" placeholder="Выберите для чего вы хотите отправиться"/>-->
        <!--        </div>-->
        <div>
          <strong>{{form.controls.travelDate.value | date:'dd.MM.yyyy'}}</strong>
          <button (click)="datepicker.click()" class="waves-effect waves-light btn" type="button">Дата поездки</button>
          <div class="rescheduleBlock">
            <button class="waves-effect waves-light btn" type="button" (click)="rescheduleForTwoWeeks()">Перенести на 2
              недели
            </button>
            <button class="waves-effect waves-light btn" type="button" (click)="rescheduleMonth()">Перенести на месяц
            </button>
          </div>
        </div>
        <div>
          <span class="addPhoto">Добавить обложку поездки</span>
          <input (change)="onFileLoad($event)" type="file" [hidden]="true" #inputFile>
          <button class="waves-effect waves-light btn" type="button" (click)="inputFile.click()">Выбрать изображение
          </button>
        </div>

        <div class="input-field select-field-item">
          <select formControlName="travelType" class="icons" (change)="travelTypeChange()">
            <option value="" disabled>Выбрать технику</option>
            <option value="onFoot" class="left">Нет</option>
            <option value="technique" class="left">Выбрать</option>
          </select>
        </div>

        <div *ngIf="this.form.controls.travelType.value === 'technique'">
          <button data-target="addTransport" class="waves-effect waves-light btn modal-trigger"
                  (click)="this.loadTransport()">Выбрать технику
          </button>
        </div>

        <div class="buttonBlock">
          <span>Куда поехать?</span>
          <button data-target="startPointMap" class="waves-effect waves-light btn modal-trigger">Указать на карте
          </button>
        </div>
        <div class="buttonBlock">
          <span>Откуда выезд?</span>
          <button data-target="endPointMap" class="waves-effect waves-light btn modal-trigger">Указать на карте</button>
        </div>
        <div class="input-field select-field-item">
          <select class="icons" formControlName="travelTarget">
            <option value="" selected disabled>Цель поездки</option>
            <option value="Охота" class="left">Охота</option>
            <option value="Рыбалка" class="left">Рыбалка</option>
            <option value="Туризм" class="left">Туризм</option>
          </select>
        </div>
        <div *ngIf="isDriver" class="input-field col s6">
          <input formControlName="peoplesCount" type="number" placeholder="Количество человек" min="1"
                 class="validate"/>
          <!--          <label for="peoplesCount">Количество человек</label>-->
          <span class="helper-text red-text" *ngIf="f.peoplesCount.touched && f.peoplesCount.invalid">
            <small *ngIf="f.peoplesCount.hasError('required')">Поле не должно быть пустым</small>
        </span>
        </div>
        <div class="input-field col s6">
          <input formControlName="costPerPeople" type="number" placeholder="Цена за 1 чел." min="0" class="validate"/>
          <!--          <label for="costPerPeople">Цена за 1 чел.</label>-->
          <span class="helper-text red-text" *ngIf="f.costPerPeople.touched && f.costPerPeople.invalid">
            <small *ngIf="f.costPerPeople.hasError('required')">Поле не должно быть пустым</small>
        </span>
        </div>
        <div class="input-field col s12">
          <textarea cols="30" rows="10" placeholder="Подробное описание" formControlName="description"></textarea>
          <!--          <label for="description">Подробное описание</label>-->
          <span class="helper-text red-text" *ngIf="f.description.touched && f.description.invalid">
            <small *ngIf="f.description.hasError('required')">Поле не должно быть пустым</small>
        </span>
        </div>
      </div>
      <div class="modal-footer">
        <button type="submit" id="button-edit-modal-close" class="btn">Обновить</button>
        <button type="button" class="btn ml10" (click)="closeModal('update')">Отмена</button>
      </div>
    </form>
  </div>
</div>
